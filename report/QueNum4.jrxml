<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="QueNum" language="groovy" pageWidth="204" pageHeight="566" columnWidth="178" leftMargin="19" rightMargin="7" topMargin="7" bottomMargin="16" isIgnorePagination="true" uuid="11b0103e-1c60-495a-a581-6a7167fe01c3">
    <property name="ireport.zoom" value="2.9282000000000266"/>
    <property name="ireport.x" value="0"/>
    <property name="ireport.y" value="0"/>
    <parameter name="counterlane" class="java.lang.String">
        <defaultValueExpression><![CDATA["ER2"]]></defaultValueExpression>
    </parameter>
    <parameter name="puserid" class="java.lang.String">
        <defaultValueExpression><![CDATA[]]></defaultValueExpression>
    </parameter>
    <parameter name="lhioname" class="java.lang.String">
        <defaultValueExpression><![CDATA[]]></defaultValueExpression>
    </parameter>
    <queryString>
		<![CDATA[SELECT CASE WHEN (u.fcnum + 1) >= u.max1 THEN u.min1 ELSE u.fcnum + 1 END maxnum, u.min1, u.max1, u.fttype, u.fcounter, u.fdescrip, u.flane, now() FROM ( SELECT CASE WHEN t.fcnum IS NULL THEN t.fcnumstart - 1 ELSE t.fcnum END fcnum, t.fcnumstart AS 'min1', t.fcnum2 AS 'max1', t.fttype, t.fcounter, t.fdescrip, t.flane FROM ( SELECT y.fcnum, x.fcnum2, x.fttype, x.fcounter, x.fdescrip, x.flane, x.fcnumstart FROM ( SELECT fcnum2, flane fttype, fcounter, fdescrip, flane, fcnum fcnumstart FROM ftable WHERE flane = $P{counterlane} ) x LEFT JOIN ( SELECT d.fcnum fcnum FROM ttable d WHERE d.fcnum >= ( SELECT fcnum FROM ftable WHERE flane = $P{counterlane} ) AND d.fcnum < ( SELECT fcnum2 FROM ftable WHERE flane = $P{counterlane}) AND d.findex = ( SELECT max(findex) FROM ttable e WHERE e.fcnum >= ( SELECT fcnum FROM ftable WHERE flane = $P{counterlane} ) AND e.fcnum < ( SELECT fcnum2 FROM ftable WHERE flane = $P{counterlane} ))) y ON x.flane = $P{counterlane} ) t ) u;]]>
    </queryString>
    <field name="maxnum" class="java.lang.String"/>
    <field name="min1" class="java.lang.String"/>
    <field name="max1" class="java.lang.String"/>
    <field name="fttype" class="java.lang.String"/>
    <field name="fcounter" class="java.lang.String">
        <fieldDescription><![CDATA[]]></fieldDescription>
    </field>
    <field name="fdescrip" class="java.lang.String">
        <fieldDescription><![CDATA[]]></fieldDescription>
    </field>
    <field name="flane" class="java.lang.String">
        <fieldDescription><![CDATA[]]></fieldDescription>
    </field>
    <field name="now()" class="java.sql.Timestamp"/>
    <background>
        <band height="136">
            <frame>
                <reportElement x="14" y="0" width="164" height="92" uuid="bfcea7d9-3481-435c-a509-f701b6b60ae2"/>
                <box>
                    <topPen lineWidth="1.75"/>
                    <bottomPen lineWidth="1.75"/>
                </box>
                <image>
                    <reportElement x="2" y="0" width="162" height="27" uuid="e9dd8301-c42e-4cf3-a98f-79211bbae71d"/>
                    <imageExpression><![CDATA["C:\\ticketing_machine\\src\\ticketing\\img\\phic.jpg"]]></imageExpression>
                </image>
            </frame>
            <textField pattern="h.mm.ss a" isBlankWhenNull="false">
                <reportElement mode="Transparent" x="42" y="92" width="95" height="11" forecolor="#000000" backcolor="#FFFFFF" uuid="cece0557-a82f-4291-b11f-1b3ab82362e1"/>
                <textElement textAlignment="Center" verticalAlignment="Middle" rotation="None" markup="none">
                    <font fontName="SansSerif" size="5" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
                    <paragraph lineSpacing="Single"/>
                </textElement>
                <textFieldExpression><![CDATA[$F{now()}]]></textFieldExpression>
            </textField>
            <textField pattern="h.mm.ss a" isBlankWhenNull="false">
                <reportElement mode="Transparent" x="137" y="92" width="41" height="11" forecolor="#000000" backcolor="#FFFFFF" uuid="162fdcdd-18b7-456a-89d0-d98e9ccd8adc"/>
                <textElement textAlignment="Center" verticalAlignment="Middle" rotation="None" markup="none">
                    <font fontName="SansSerif" size="5" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
                    <paragraph lineSpacing="Single"/>
                </textElement>
                <textFieldExpression><![CDATA[$P{puserid}]]></textFieldExpression>
            </textField>
            <staticText>
                <reportElement x="15" y="103" width="163" height="12" uuid="ecdd3168-fe89-4a4d-bddf-b775564a3831"/>
                <textElement textAlignment="Center" verticalAlignment="Middle">
                    <font size="4" isBold="true"/>
                </textElement>
                <text><![CDATA[If your Queue Number was called and you're not
around, this Queue Number will be VOID.]]></text>
            </staticText>
        </band>
    </background>
    <columnHeader>
        <band height="47">
            <staticText>
                <reportElement x="15" y="32" width="165" height="15" uuid="5c5b26db-f89d-4081-aee1-d15ec08acd0f"/>
                <textElement textAlignment="Center" verticalAlignment="Middle">
                    <font size="8" isBold="false"/>
                </textElement>
                <text><![CDATA[Your Queue Number is]]></text>
            </staticText>
            <textField>
                <reportElement x="54" y="22" width="71" height="10" uuid="3239de64-8b66-4a6f-ad3c-c7170d50ff50"/>
                <textElement textAlignment="Center" verticalAlignment="Middle">
                    <font size="5"/>
                </textElement>
                <textFieldExpression><![CDATA[$P{lhioname}]]></textFieldExpression>
            </textField>
        </band>
    </columnHeader>
    <detail>
        <band height="56">
            <textField>
                <reportElement x="16" y="29" width="164" height="14" uuid="58a56da7-7121-4c6c-a13c-363936110530"/>
                <textElement textAlignment="Center" verticalAlignment="Middle">
                    <font size="10" isBold="true"/>
                </textElement>
                <textFieldExpression><![CDATA[$F{fdescrip}]]></textFieldExpression>
            </textField>
            <textField>
                <reportElement x="16" y="-12" width="162" height="45" uuid="4cf15a45-a1a3-42de-9696-0feaed21a7a9"/>
                <textElement textAlignment="Center" verticalAlignment="Middle">
                    <font size="32" isBold="true"/>
                </textElement>
                <textFieldExpression><![CDATA[$F{maxnum}]]></textFieldExpression>
            </textField>
        </band>
    </detail>
</jasperReport>
